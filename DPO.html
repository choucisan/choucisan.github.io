<!DOCTYPE html><html lang="en,zh-CN"><head><meta charset="UTF-8"><meta name="baidu-site-verification" content="codeva-X99uCprQdB"><link rel="apple-touch-icon" sizes="76x76" href="/img/logo.jpg"><link rel="icon" href="/img/logo.jpg"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="choucisan"><meta name="keywords" content=""><meta name="description" content="å¼•è¨€ï¼š ç›´æ¥åå¥½ä¼˜åŒ–ç®—æ³•ï¼ˆDPOï¼‰æ˜¯ä¸€ç§æ–°çš„å‚æ•°åŒ–æ–¹å¼ï¼Œèƒ½å¤Ÿä»¥é—­å¼è§£çš„å½¢å¼æå–ç›¸åº”çš„æœ€ä¼˜ç­–ç•¥ï¼Œä½¿ä»…é€šè¿‡ç®€å•çš„åˆ†ç±»æŸå¤±å°±èƒ½è§£å†³æ ‡å‡†çš„RLHFé—®é¢˜ã€‚å®ƒç¨³å®šã€é«˜æ•ˆä¸”è®¡ç®—é‡å°ï¼Œæ— éœ€åœ¨å¾®è°ƒè¿‡ç¨‹ä¸­ä»è¯­è¨€æ¨¡å‹ä¸­è¿›è¡Œé‡‡æ ·ï¼Œä¹Ÿä¸éœ€è¦è¿›è¡Œå¤§é‡çš„è¶…å‚æ•°è°ƒæ•´ã€‚æˆ‘ä»¬çš„å®éªŒè¡¨æ˜ï¼ŒDPOèƒ½å¤Ÿå¯¹è¯­è¨€æ¨¡å‹è¿›è¡Œå¾®è°ƒï¼Œä½¿å…¶ä¸äººç±»åå¥½ä¿æŒä¸€è‡´ï¼Œæ•ˆæœè¾¾åˆ°ç”šè‡³ä¼˜äºç°æœ‰æ–¹æ³•ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨DPOè¿›è¡Œå¾®è°ƒåœ¨æ§åˆ¶ç”Ÿæˆ"><meta property="og:type" content="article"><meta property="og:title" content="DPOâ€”â€”ç›´æ¥åå¥½ä¼˜åŒ–ç®—æ³•"><meta property="og:url" content="https://choucisan.xyz/DPO.html"><meta property="og:site_name" content="choucisan&#39;s blog"><meta property="og:description" content="å¼•è¨€ï¼š ç›´æ¥åå¥½ä¼˜åŒ–ç®—æ³•ï¼ˆDPOï¼‰æ˜¯ä¸€ç§æ–°çš„å‚æ•°åŒ–æ–¹å¼ï¼Œèƒ½å¤Ÿä»¥é—­å¼è§£çš„å½¢å¼æå–ç›¸åº”çš„æœ€ä¼˜ç­–ç•¥ï¼Œä½¿ä»…é€šè¿‡ç®€å•çš„åˆ†ç±»æŸå¤±å°±èƒ½è§£å†³æ ‡å‡†çš„RLHFé—®é¢˜ã€‚å®ƒç¨³å®šã€é«˜æ•ˆä¸”è®¡ç®—é‡å°ï¼Œæ— éœ€åœ¨å¾®è°ƒè¿‡ç¨‹ä¸­ä»è¯­è¨€æ¨¡å‹ä¸­è¿›è¡Œé‡‡æ ·ï¼Œä¹Ÿä¸éœ€è¦è¿›è¡Œå¤§é‡çš„è¶…å‚æ•°è°ƒæ•´ã€‚æˆ‘ä»¬çš„å®éªŒè¡¨æ˜ï¼ŒDPOèƒ½å¤Ÿå¯¹è¯­è¨€æ¨¡å‹è¿›è¡Œå¾®è°ƒï¼Œä½¿å…¶ä¸äººç±»åå¥½ä¿æŒä¸€è‡´ï¼Œæ•ˆæœè¾¾åˆ°ç”šè‡³ä¼˜äºç°æœ‰æ–¹æ³•ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨DPOè¿›è¡Œå¾®è°ƒåœ¨æ§åˆ¶ç”Ÿæˆ"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://images.unsplash.com/photo-1665559490709-bacaefc49b7b?q=80&w=2071&auto=format&fit=crop"><meta property="article:published_time" content="2025-12-21T09:58:52.000Z"><meta property="article:modified_time" content="2025-12-12T09:20:44.148Z"><meta property="article:author" content="choucisan"><meta property="article:tag" content="Research"><meta property="article:tag" content="Algorithm"><meta property="article:tag" content="DPO"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://images.unsplash.com/photo-1665559490709-bacaefc49b7b?q=80&w=2071&auto=format&fit=crop"><title>DPOâ€”â€”ç›´æ¥åå¥½ä¼˜åŒ–ç®—æ³• - choucisan&#39;s blog</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link rel="stylesheet" href="/css/fullscreen-style.css"><script id="fluid-configs">var dntVal,Fluid=window.Fluid||{},CONFIG=(Fluid.ctx=Object.assign({},Fluid.ctx),{hostname:"choucisan.xyz",root:"/",version:"1.9.8",typing:{enable:!1,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!1,baidu:null,google:{measurement_id:null},tencent:{sid:null,cid:null},leancloud:{app_id:"VnqS06x2hxlj7MEjoUAix6L5-gzGzoHsz",app_key:"ck0fCo8cxJs0OdTEdWmSl9l1",server_url:"https://vnqs06x2.lc-cn-n1-shared.com",path:"window.location.pathname",ignore_local:!1},umami:{src:null,website_id:null,domains:null,start_time:"2025-01-01T00:00:00.000Z",token:null,api_server:null}},search_path:"/local-search.xml",include_content_in_search:!0});CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css"><meta name="generator" content="Hexo 7.3.0"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>13log</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/" target="_self"><span>HOME</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/" target="_self"><span>ARCHIVES</span></a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>TOPICS</span></a><div class="dropdown-menu" aria-labelledby="navbarDropdown"><a class="dropdown-item" href="/categories/Pub/" target="_self"><span>Publications</span> </a><a class="dropdown-item" href="/categories/OpenSource/" target="_self"><span>Open Source</span> </a><a class="dropdown-item" href="/categories/Paper/" target="_self"><span>Paper Reading</span> </a><a class="dropdown-item" href="/categories/Tech/" target="_self"><span>Tech Share</span> </a><a class="dropdown-item" href="/categories/Life/" target="_self"><span>Life Share</span></a></div></li><li class="nav-item"><a class="nav-link" href="/about/" target="_self"><span>ABOUT</span></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle">DPOâ€”â€”ç›´æ¥åå¥½ä¼˜åŒ–ç®—æ³•</span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2025-12-21 17:58" pubdate>December 21, 2025 pm</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 3.5k words </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 30 mins </span><span id="leancloud-page-views-container" class="post-meta" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="leancloud-page-views"></span> views</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 id="seo-header">DPOâ€”â€”ç›´æ¥åå¥½ä¼˜åŒ–ç®—æ³•</h1><div class="markdown-body"><div class="note note-info"><p><strong>å¼•è¨€ï¼š</strong> ç›´æ¥åå¥½ä¼˜åŒ–ç®—æ³•ï¼ˆDPOï¼‰æ˜¯ä¸€ç§æ–°çš„å‚æ•°åŒ–æ–¹å¼ï¼Œèƒ½å¤Ÿä»¥é—­å¼è§£çš„å½¢å¼æå–ç›¸åº”çš„æœ€ä¼˜ç­–ç•¥ï¼Œä½¿ä»…é€šè¿‡ç®€å•çš„åˆ†ç±»æŸå¤±å°±èƒ½è§£å†³æ ‡å‡†çš„RLHFé—®é¢˜ã€‚å®ƒç¨³å®šã€é«˜æ•ˆä¸”è®¡ç®—é‡å°ï¼Œæ— éœ€åœ¨å¾®è°ƒè¿‡ç¨‹ä¸­ä»è¯­è¨€æ¨¡å‹ä¸­è¿›è¡Œé‡‡æ ·ï¼Œä¹Ÿä¸éœ€è¦è¿›è¡Œå¤§é‡çš„è¶…å‚æ•°è°ƒæ•´ã€‚æˆ‘ä»¬çš„å®éªŒè¡¨æ˜ï¼ŒDPOèƒ½å¤Ÿå¯¹è¯­è¨€æ¨¡å‹è¿›è¡Œå¾®è°ƒï¼Œä½¿å…¶ä¸äººç±»åå¥½ä¿æŒä¸€è‡´ï¼Œæ•ˆæœè¾¾åˆ°ç”šè‡³ä¼˜äºç°æœ‰æ–¹æ³•ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨DPOè¿›è¡Œå¾®è°ƒåœ¨æ§åˆ¶ç”Ÿæˆå†…å®¹çš„æƒ…æ„Ÿæ–¹é¢è¶…è¿‡äº†åŸºäºPPOçš„RLHFï¼Œå¹¶ä¸”åœ¨æ‘˜è¦å’Œå•è½®å¯¹è¯ä»»åŠ¡ä¸­ï¼Œåœ¨å“åº”è´¨é‡ä¸Šä¸ä¹‹ç›¸å½“æˆ–æœ‰æ‰€æå‡ï¼ŒåŒæ—¶å®ç°å’Œè®­ç»ƒè¿‡ç¨‹ä¹Ÿç®€å•å¾—å¤šã€‚</p></div><h2 id="dpoç®—æ³•ä»‹ç»">âœˆï¸ DPOç®—æ³•ä»‹ç»</h2><h3 id="ç®—æ³•å½’ç±»">ç®—æ³•å½’ç±»</h3><p>DPOï¼ˆDirect Preference Optimizationï¼‰åœ¨å¼ºåŒ–å­¦ä¹ ä¸å¤§æ¨¡å‹å¾®è°ƒçš„ç‰ˆå›¾ä¸­ï¼Œå±äºä¸€ç§<strong>è¿”ç’å½’çœŸ</strong>çš„ç®—æ³•ï¼š</p><ul><li><strong>ç¦»çº¿ç­–ç•¥ (Off-Policy / Offline)</strong>ï¼šä¸¥æ ¼æ¥è¯´ï¼ŒDPO æ›´æ¥è¿‘äºç›‘ç£å­¦ä¹ ã€‚å®ƒä¸éœ€è¦åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­è®©æ¨¡å‹å®æ—¶ç”Ÿæˆæ•°æ®ï¼ˆåƒ PPO é‚£æ ·é‡‡æ ·ï¼‰ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨é¢„å…ˆæ„å»ºå¥½çš„åå¥½æ•°æ®é›†ï¼ˆTriplets: Prompt, Winner, Loserï¼‰ã€‚</li><li><strong>åŸºäºç­–ç•¥ (Policy-Based)</strong>ï¼šå®ƒç›´æ¥ä¼˜åŒ–ç­–ç•¥ç½‘ç»œï¼ˆLLMæœ¬èº«ï¼‰ï¼Œæ²¡æœ‰æ˜¾å¼çš„ä»·å€¼å‡½æ•°ï¼ˆValue Functionï¼‰ã€‚</li><li><strong>æ— å¥–åŠ±æ¨¡å‹ (Reward-Free)</strong>ï¼šè¿™æ˜¯ DPO æœ€æ˜¾è‘—çš„æ ‡ç­¾ã€‚å®ƒä¸éœ€è¦è®­ç»ƒä¸€ä¸ªç‹¬ç«‹çš„ Reward Modelï¼Œè€Œæ˜¯é€šè¿‡æ•°å­¦å˜æ¢ï¼Œå°†â€œå¥–åŠ±â€éšå¼åœ°åŒ…å«åœ¨ç­–ç•¥æ¨¡å‹ä¸­ã€‚</li></ul><h3 id="é€‚ç”¨èŒƒå›´ä¸å±€é™">é€‚ç”¨èŒƒå›´ä¸å±€é™</h3><ul><li><strong>é€‚ç”¨èŒƒå›´</strong>ï¼š<ul><li><strong>RLHF æ›¿ä»£æ–¹æ¡ˆ</strong>ï¼šé€‚ç”¨äºæ‰€æœ‰éœ€è¦äººç±»åå¥½å¯¹é½çš„åœºæ™¯ï¼Œå¦‚èŠå¤©æœºå™¨äººï¼ˆChatbotï¼‰ã€æ–‡æœ¬æ‘˜è¦ã€æŒ‡ä»¤è·Ÿéšç­‰ã€‚</li><li><strong>èµ„æºå—é™åœºæ™¯</strong>ï¼šç”±äºä¸éœ€è¦åŠ è½½ Critic å’Œ Reward Modelï¼ŒDPO çš„æ˜¾å­˜å ç”¨çº¦ä¸º PPO çš„ä¸€åŠï¼Œéå¸¸é€‚åˆåœ¨æœ‰é™æ˜¾å­˜ä¸‹å¾®è°ƒå¤§æ¨¡å‹ã€‚</li></ul></li><li><strong>å±€é™æ€§</strong>ï¼š<ul><li><strong>æ•°æ®åˆ†å¸ƒåç§» (Out-of-Distribution)</strong>ï¼šDPO å±äºç¦»çº¿å­¦ä¹ ï¼Œå¦‚æœåå¥½æ•°æ®é›†çš„åˆ†å¸ƒä¸æ¨¡å‹å®é™…ç”Ÿæˆçš„åˆ†å¸ƒå·®å¼‚è¿‡å¤§ï¼Œæ•ˆæœå¯èƒ½ä¼šæ‰“æŠ˜æ‰£ã€‚</li><li><strong>ç¼ºä¹æ¢ç´¢ (Lack of Exploration)</strong>ï¼šPPO åœ¨è®­ç»ƒä¸­ä¼šç”Ÿæˆæ–°æ•°æ®è¿›è¡Œæ¢ç´¢ï¼Œè€Œ DPO ä»…åŸºäºç»™å®šæ•°æ®ã€‚å¯¹äºéœ€è¦æå¼ºé€»è¾‘æ¨ç†æˆ–è§£ç©ºé—´å¾ˆå¤§çš„ä»»åŠ¡ï¼ˆå¦‚æ•°å­¦è¯æ˜ï¼‰ï¼ŒDPO å¯èƒ½ä¸å¦‚åœ¨çº¿ RL æ–¹æ³•ï¼ˆå¦‚ PPO æˆ– GRPOï¼‰ã€‚</li></ul></li></ul><h3 id="åŸºæœ¬æ€æƒ³">åŸºæœ¬æ€æƒ³</h3><p>DPO çš„æ ¸å¿ƒæ´å¯Ÿæå…¶ç²¾å¦™ï¼š<strong>â€œå¥–åŠ±å‡½æ•° <span class="math inline"><em>r</em></span> å’Œæœ€ä¼˜ç­–ç•¥ <span class="math inline"><em>Ï€</em><sup>*</sup></span> æ˜¯ä¸€ä½“ä¸¤é¢çš„ã€‚â€</strong></p><p>åœ¨ PPO ä¸­ï¼Œæˆ‘ä»¬å…ˆè®­ç»ƒä¸€ä¸ªå¥–åŠ±æ¨¡å‹ <span class="math inline"><em>r</em>(<em>x</em>,â€†<em>y</em>)</span>ï¼Œç„¶åè®­ç»ƒç­–ç•¥ <span class="math inline"><em>Ï€</em></span> å»æœ€å¤§åŒ–è¿™ä¸ª <span class="math inline"><em>r</em></span>ã€‚ DPO çš„ä½œè€…å‘ç°ï¼Œå¯¹äºä¸€ä¸ªç‰¹å®šçš„å¥–åŠ±å‡½æ•°ï¼Œæœ€ä¼˜ç­–ç•¥ <span class="math inline"><em>Ï€</em><sup>*</sup></span> çš„è§£æè§£æ˜¯å¯ä»¥å†™å‡ºæ¥çš„ã€‚æ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆä¸åè¿‡æ¥ï¼Œ<strong>ç”¨ç­–ç•¥ <span class="math inline"><em>Ï€</em></span> æ¥è¡¨ç¤ºå¥–åŠ± <span class="math inline"><em>r</em></span> å‘¢ï¼Ÿ</strong></p><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠ RLHF ä¸­é‚£ä¸ªâ€œåŸºäºå¥–åŠ±æ¨¡å‹çš„ Bradley-Terry åå¥½æ¦‚ç‡â€ï¼Œç›´æ¥è½¬åŒ–ä¸ºâ€œåŸºäºç­–ç•¥æ¦‚ç‡çš„åˆ†ç±»é—®é¢˜â€ã€‚</p><hr><h2 id="dpoç®—æ³•æµç¨‹">ğŸš€ DPOç®—æ³•æµç¨‹</h2><p>DPO çš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äºå°†å¤æ‚çš„å¼ºåŒ–å­¦ä¹ è¿‡ç¨‹ç®€åŒ–ä¸ºç›´è§‚çš„<strong>æœ€å¤§ä¼¼ç„¶ä¼˜åŒ–</strong>è¿‡ç¨‹ã€‚å®ƒä¸å†éœ€è¦ç»éªŒå›æ”¾æ± ï¼ˆReplay Bufferï¼‰å’Œå¤æ‚çš„é‡‡æ ·ï¼ˆSamplingï¼‰ï¼Œè€Œæ˜¯ç›´æ¥åœ¨é™æ€æ•°æ®ä¸Šè¿›è¡Œè®¡ç®—ã€‚</p><figure><img src="/images/rl/dpo.webp" srcset="/img/loading.gif" lazyload alt="DPOç®—æ³•æµç¨‹å›¾"><figcaption aria-hidden="true">DPOç®—æ³•æµç¨‹å›¾</figcaption></figure><h3 id="dpoç®—æ³•æ¨å¯¼">DPOç®—æ³•æ¨å¯¼</h3><p>è¿™æ˜¯ DPO æœ€æ ¸å¿ƒçš„æ•°å­¦é­”æ³•ã€‚æˆ‘ä»¬åˆ†ä¸‰æ­¥èµ°ï¼š</p><p><strong>RLHF çš„ç›®æ ‡å‡½æ•°</strong> æ ‡å‡†çš„ RLHF ç›®æ ‡æ˜¯æœ€å¤§åŒ–å¥–åŠ±ï¼ŒåŒæ—¶é€šè¿‡ KL æ•£åº¦çº¦æŸä¸åç¦»å‚è€ƒæ¨¡å‹ <span class="math inline"><em>Ï€</em><sub><em>r</em><em>e</em><em>f</em></sub></span>ï¼š <span class="math display">$$ \max_{\pi} \mathbb{E}_{x \sim D, y \sim \pi} [r(x,y) - \beta \log \frac{\pi(y|x)}{\pi_{ref}(y|x)}] $$</span></p><p><strong>æœ€ä¼˜ç­–ç•¥çš„è§£æè§£</strong> é€šè¿‡å˜åˆ†æ³•æ±‚è§£ä¸Šè¿°æœ€ä¼˜åŒ–é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°<strong>æœ€ä¼˜ç­–ç•¥ <span class="math inline"><em>Ï€</em><sup>*</sup></span> çš„é—­å¼è§£</strong>ï¼š <span class="math display">$$ \pi^*(y|x) = \frac{1}{Z(x)} \pi_{ref}(y|x) \exp\left(\frac{r(x,y)}{\beta}\right) $$</span> å…¶ä¸­ <span class="math inline"><em>Z</em>(<em>x</em>)</span> æ˜¯å½’ä¸€åŒ–å› å­ã€‚</p><p><strong>åè§£å¥–åŠ±å‡½æ•° (The Magic)</strong> ç°åœ¨ï¼Œæˆ‘ä»¬å¯¹ä¸Šé¢çš„å…¬å¼è¿›è¡Œç§»é¡¹ï¼ŒæŠŠå¥–åŠ±å‡½æ•° <span class="math inline"><em>r</em>(<em>x</em>,â€†<em>y</em>)</span> å•ç‹¬è§£å‡ºæ¥ï¼š <span class="math display">$$ r(x,y) = \beta \log \frac{\pi^*(y|x)}{\pi_{ref}(y|x)} + \beta \log Z(x) $$</span> <strong>è¿™ä¸ªå…¬å¼ä¸ä»…æ¶ˆé™¤äº†æ˜¾å¼çš„å¥–åŠ±æ¨¡å‹ï¼Œè¿˜æŠŠå¥–åŠ±ç›´æ¥æŒ‚é’©åˆ°äº†ç­–ç•¥æ¦‚ç‡ä¸Šï¼</strong></p><p><strong>ä»£å…¥ Bradley-Terry æ¨¡å‹</strong> Bradley-Terry æ¨¡å‹å®šä¹‰äº†åå¥½æ¦‚ç‡ï¼š <span class="math display"><em>P</em>(<em>y</em><sub><em>w</em></sub>â€„&gt;â€„<em>y</em><sub><em>l</em></sub>)â€„=â€„<em>Ïƒ</em>(<em>r</em>(<em>x</em>,â€†<em>y</em><sub><em>w</em></sub>)â€…âˆ’â€…<em>r</em>(<em>x</em>,â€†<em>y</em><sub><em>l</em></sub>))</span> æˆ‘ä»¬å°†ç¬¬ä¸‰æ­¥åè§£å‡ºçš„ <span class="math inline"><em>r</em>(<em>x</em>,â€†<em>y</em>)</span> ä»£å…¥ä¸Šå¼ï¼ˆæ³¨æ„ <span class="math inline"><em>Z</em>(<em>x</em>)</span> ä¼šè¢«æ¶ˆæ‰ï¼‰ï¼Œæœ€ç»ˆå¾—åˆ°äº† <strong>DPO çš„æŸå¤±å‡½æ•°</strong>ï¼š</p><p><span class="math display">$$ L_{DPO}(\pi_\theta; \pi_{ref}) = - \mathbb{E}_{(x, y_w, y_l) \sim D} \left[ \log \sigma \left( \beta \log \frac{\pi_\theta(y_w|x)}{\pi_{ref}(y_w|x)} - \beta \log \frac{\pi_\theta(y_l|x)}{\pi_{ref}(y_l|x)} \right) \right] $$</span></p><h3 id="dpoç®—æ³•å®ç°æµç¨‹">DPOç®—æ³•å®ç°æµç¨‹</h3><p>DPO çš„å®é™…è®­ç»ƒè¿‡ç¨‹ç±»ä¼¼äºç›‘ç£å­¦ä¹ ï¼ˆSupervised Learningï¼‰ï¼Œä½†éœ€è¦åŒæ—¶ç»´æŠ¤ä¸¤ä¸ªæ¨¡å‹è¿›è¡Œå‰å‘ä¼ æ’­ã€‚ä»¥ä¸‹æ˜¯å•æ­¥æ›´æ–°çš„å®Œæ•´é€»è¾‘æµç¨‹ï¼š</p><ul><li><strong>è¾“å…¥å‡†å¤‡ (Input Preparation)</strong><ul><li>ä»åå¥½æ•°æ®é›† <span class="math inline"><em>D</em></span> ä¸­é‡‡æ ·ä¸€ä¸ªæ‰¹æ¬¡çš„æ•°æ®ã€‚</li><li>æ¯æ¡æ•°æ®åŒ…å«ä¸‰éƒ¨åˆ†ï¼šæç¤ºè¯ <span class="math inline"><em>x</em></span> (Prompt)ï¼Œäººç±»åå¥½çš„å›ç­” <span class="math inline"><em>y</em><sub><em>w</em></sub></span> (Winner)ï¼Œäººç±»æ’æ–¥çš„å›ç­” <span class="math inline"><em>y</em><sub><em>l</em></sub></span> (Loser)ã€‚</li></ul></li><li><strong>å‚è€ƒæ¨¡å‹å‰å‘ä¼ æ’­ (Reference Forward)</strong><ul><li>ä½¿ç”¨<strong>å‚è€ƒæ¨¡å‹</strong>ï¼ˆå†»ç»“å‚æ•°ï¼Œä¸æ›´æ–°ï¼‰åˆ†åˆ«è®¡ç®— <span class="math inline"><em>y</em><sub><em>w</em></sub></span> å’Œ <span class="math inline"><em>y</em><sub><em>l</em></sub></span> çš„å¯¹æ•°æ¦‚ç‡ã€‚</li><li>è¾“å‡ºï¼š<span class="math inline">logâ€†<em>Ï€</em><sub><em>r</em><em>e</em><em>f</em></sub>(<em>y</em><sub><em>w</em></sub>|<em>x</em>)</span> å’Œ <span class="math inline">logâ€†<em>Ï€</em><sub><em>r</em><em>e</em><em>f</em></sub>(<em>y</em><sub><em>l</em></sub>|<em>x</em>)</span>ã€‚</li></ul></li><li><strong>ç­–ç•¥æ¨¡å‹å‰å‘ä¼ æ’­ (Policy Forward)</strong><ul><li>ä½¿ç”¨<strong>å½“å‰ç­–ç•¥æ¨¡å‹</strong>ï¼ˆéœ€è¦æ›´æ–°å‚æ•°ï¼‰åˆ†åˆ«è®¡ç®— <span class="math inline"><em>y</em><sub><em>w</em></sub></span> å’Œ <span class="math inline"><em>y</em><sub><em>l</em></sub></span> çš„å¯¹æ•°æ¦‚ç‡ã€‚</li><li>è¾“å‡ºï¼š<span class="math inline">logâ€†<em>Ï€</em><sub><em>Î¸</em></sub>(<em>y</em><sub><em>w</em></sub>|<em>x</em>)</span> å’Œ <span class="math inline">logâ€†<em>Ï€</em><sub><em>Î¸</em></sub>(<em>y</em><sub><em>l</em></sub>|<em>x</em>)</span>ã€‚</li></ul></li><li><strong>è®¡ç®—éšå¼å¥–åŠ± (Implicit Reward Calculation)</strong><ul><li>è®¡ç®—ä¸¤ä¸ªæ¨¡å‹å¯¹â€œèƒœå‡ºå›ç­”â€çš„æ¦‚ç‡å·®å€¼ï¼ˆLog Ratioï¼‰ï¼š<span class="math inline"><em>R</em><sub><em>w</em></sub>â€„=â€„<em>Î²</em>(logâ€†<em>Ï€</em><sub><em>Î¸</em></sub>(<em>y</em><sub><em>w</em></sub>|<em>x</em>)â€…âˆ’â€…logâ€†<em>Ï€</em><sub><em>r</em><em>e</em><em>f</em></sub>(<em>y</em><sub><em>w</em></sub>|<em>x</em>))</span></li><li>è®¡ç®—ä¸¤ä¸ªæ¨¡å‹å¯¹â€œè½è´¥å›ç­”â€çš„æ¦‚ç‡å·®å€¼ï¼ˆLog Ratioï¼‰ï¼š<span class="math inline"><em>R</em><sub><em>l</em></sub>â€„=â€„<em>Î²</em>(logâ€†<em>Ï€</em><sub><em>Î¸</em></sub>(<em>y</em><sub><em>l</em></sub>|<em>x</em>)â€…âˆ’â€…logâ€†<em>Ï€</em><sub><em>r</em><em>e</em><em>f</em></sub>(<em>y</em><sub><em>l</em></sub>|<em>x</em>))</span></li><li><em>æ³¨ï¼šè¿™é‡Œçš„ <span class="math inline"><em>R</em><sub><em>w</em></sub></span> å’Œ <span class="math inline"><em>R</em><sub><em>l</em></sub></span> å®é™…ä¸Šä»£è¡¨äº†æ¨¡å‹ç›¸å¯¹äºå‚è€ƒæ¨¡å‹è·å¾—çš„â€œéšå¼å¥–åŠ±â€ã€‚</em></li></ul></li><li><strong>è®¡ç®—æŸå¤±ä¸åå‘ä¼ æ’­ (Loss &amp; Backward)</strong><ul><li>è®¡ç®—ä¸¤è€…çš„å¥–åŠ±å·®å€¼ï¼ˆMarginï¼‰ï¼š<span class="math inline"><em>M</em><em>a</em><em>r</em><em>g</em><em>i</em><em>n</em>â€„=â€„<em>R</em><sub><em>w</em></sub>â€…âˆ’â€…<em>R</em><sub><em>l</em></sub></span>ã€‚</li><li>å°†å·®å€¼é€šè¿‡ Sigmoid å‡½æ•°å¹¶å–è´Ÿå¯¹æ•°ï¼Œå¾—åˆ°åˆ†ç±»æŸå¤±ï¼š<span class="math inline"><em>L</em><em>o</em><em>s</em><em>s</em>â€„=â€„âˆ’logâ€†<em>Ïƒ</em>(<em>M</em><em>a</em><em>r</em><em>g</em><em>i</em><em>n</em>)</span>ã€‚</li><li><strong>ç›´è§‚ç†è§£</strong>ï¼šæˆ‘ä»¬å¸Œæœ› <span class="math inline"><em>R</em><sub><em>w</em></sub></span> è¶Šå¤§è¶Šå¥½ï¼Œ<span class="math inline"><em>R</em><sub><em>l</em></sub></span> è¶Šå°è¶Šå¥½ï¼Œå³æ‹‰å¤§èƒœè€…å’Œè´¥è€…ä¹‹é—´çš„è·ç¦»ã€‚</li><li>æ ¹æ® Loss è®¡ç®—æ¢¯åº¦ï¼Œæ›´æ–°<strong>å½“å‰ç­–ç•¥æ¨¡å‹</strong>çš„å‚æ•° <span class="math inline"><em>Î¸</em></span>ã€‚</li></ul></li></ul><p>é€šè¿‡ä¸æ–­å¾ªç¯ä¸Šè¿°æ­¥éª¤ï¼Œç­–ç•¥æ¨¡å‹ <span class="math inline"><em>Ï€</em><sub><em>Î¸</em></sub></span> ä¼šé€æ¸â€œè¿œç¦»â€å‚è€ƒæ¨¡å‹å¯¹å·®ç­”æ¡ˆçš„ç”Ÿæˆæ¦‚ç‡ï¼Œå¹¶â€œé è¿‘â€å‚è€ƒæ¨¡å‹å¯¹å¥½ç­”æ¡ˆçš„ç”Ÿæˆæ¦‚ç‡ï¼ˆåŒæ—¶åŠ å…¥äººç±»åå¥½çš„ä¿®æ­£ï¼‰ã€‚</p><h2 id="dpoçš„ç†è®ºåˆ†æ">ğŸ”¥ DPOçš„ç†è®ºåˆ†æ</h2><h3 id="llmä¸å¥–åŠ±æ¨¡å‹">LLMä¸å¥–åŠ±æ¨¡å‹</h3><p>åœ¨ PPO æ—¶ä»£ï¼Œæˆ‘ä»¬éœ€è¦è®­ç»ƒä¸€ä¸ªæ˜¾å¼çš„ <strong>Reward Model (RM)</strong> æ¥å……å½“â€œåˆ¤å·è€å¸ˆâ€ï¼Œå‘Šè¯‰ç­–ç•¥æ¨¡å‹å“ªå¥è¯å†™å¾—å¥½ã€‚ä½† DPO çš„æ•°å­¦æ¨å¯¼æ­ç¤ºäº†ä¸€ä¸ªæ·±åˆ»çš„ç†è®ºäº‹å®ï¼š</p><p><strong>è¯­è¨€æ¨¡å‹æœ¬èº«å°±éšå«äº†ä¸€ä¸ªå¥–åŠ±æ¨¡å‹ã€‚</strong></p><ul><li><strong>å†—ä½™æ€§</strong>ï¼šå½“æˆ‘ä»¬è®­ç»ƒ LLM å»é€¼è¿‘æœ€ä¼˜ç­–ç•¥ <span class="math inline"><em>Ï€</em><sup>*</sup></span> æ—¶ï¼Œç­–ç•¥æ¨¡å‹çš„æ¦‚ç‡åˆ†å¸ƒå˜åŒ– <span class="math inline">$\frac{\pi(y|x)}{\pi_{ref}(y|x)}$</span> å…¶å®å°±æ˜¯åœ¨éšå¼åœ°è¡¨è¾¾å®ƒå¯¹å›å¤çš„åå¥½ã€‚</li><li><strong>å»ä¸­å¿ƒåŒ–</strong>ï¼šå› æ­¤ï¼Œç»´æŠ¤ä¸€ä¸ªç‹¬ç«‹çš„ Reward Model å…¶å®æ˜¯<strong>å†—ä½™</strong>çš„ï¼Œç”šè‡³å¯èƒ½å› ä¸º RM è‡ªèº«çš„åå·®å¼•å…¥é¢å¤–çš„æ‹Ÿåˆè¯¯å·®ã€‚DPO ç›´æ¥ä¼˜åŒ–ç­–ç•¥ï¼Œç›¸å½“äº<strong>å»æ‰äº†â€œä¸­é—´å•†â€</strong>ï¼Œè®©åå¥½æ•°æ®ç›´æ¥æŒ‡å¯¼è¯­è¨€æ¨¡å‹çš„ç”Ÿæˆæ¦‚ç‡ã€‚</li></ul><h3 id="actor-critic-algorithms-çš„ä¸ç¨³å®šæ€§">Actor-Critic Algorithms çš„ä¸ç¨³å®šæ€§</h3><p>ä¸ºä»€ä¹ˆ PPO è¿™ç§ Actor-Critic ç®—æ³•åœ¨å¤§æ¨¡å‹å¾®è°ƒä¸­å¦‚æ­¤éš¾è®­ï¼Ÿæ ¹æœ¬åŸå› åœ¨äºæ¶æ„å†…éƒ¨çš„<strong>å¤æ‚åŠ¨æ€åšå¼ˆ</strong>ï¼š</p><ul><li><strong>ç§»åŠ¨çš„é¶å­ (Moving Target)</strong>ï¼š<ul><li>Actor ä¾èµ– Critic çš„æ‰“åˆ†æ¥æ›´æ–°å‚æ•°ã€‚</li><li>Critic ä¾èµ– Actor é‡‡æ ·çš„æ•°æ®æ¥æ›´æ–°å‚æ•°ã€‚</li><li>åªè¦å…¶ä¸­ä¸€æ–¹ç¨å¾®â€œè·‘åâ€ï¼Œå¦ä¸€æ–¹å°±ä¼šè·Ÿç€å­¦åï¼Œå¯¼è‡´è®­ç»ƒéœ‡è¡ç”šè‡³å´©å¡Œã€‚</li></ul></li><li><strong>å¤æ‚çš„è¶…å‚æ•°åè°ƒ</strong>ï¼š<ul><li>PPO éœ€è¦åŒæ—¶ç»´æŠ¤ Actorã€Criticã€Reward Modelã€Reference Model å››ä¸ªç½‘ç»œã€‚</li><li>éœ€è¦ç²¾ç»†è°ƒèŠ‚ GAE ç³»æ•° <span class="math inline"><em>Î»</em></span>ã€æˆªæ–­ç³»æ•° <span class="math inline"><em>Ïµ</em></span>ã€ä»·å€¼æŸå¤±ç³»æ•° <span class="math inline"><em>c</em><sub>1</sub></span>ã€ç†µç³»æ•° <span class="math inline"><em>c</em><sub>2</sub></span> ç­‰ï¼Œç‰µä¸€å‘è€ŒåŠ¨å…¨èº«ã€‚</li></ul></li></ul><p><strong>DPO çš„ç¨³å®šæ€§ä¼˜åŠ¿</strong>ï¼š DPO å°†å¤æ‚çš„å¼ºåŒ–å­¦ä¹ é—®é¢˜è½¬åŒ–ä¸ºäº†ä¸€ä¸ªç®€å•çš„<strong>äºŒåˆ†ç±»ç›‘ç£å­¦ä¹ é—®é¢˜</strong>ã€‚</p><ul><li><strong>æ—  Critic</strong>ï¼šæ¶ˆé™¤äº†ä»·å€¼ä¼°è®¡å¸¦æ¥çš„åå·®å’Œæ–¹å·®ã€‚</li><li><strong>æ— é‡‡æ ·</strong>ï¼šæ¶ˆé™¤äº†ç”Ÿæˆè¿‡ç¨‹ä¸­çš„éšæœºæ€§ã€‚</li><li><strong>å‡¸ä¼˜åŒ–æ€§è´¨</strong>ï¼šDPO çš„ç›®æ ‡å‡½æ•°æ€§è´¨æ›´å¥½ï¼ˆæ¥è¿‘å‡¸å‡½æ•°ï¼‰ï¼Œè¿™ä½¿å¾—è®­ç»ƒè¿‡ç¨‹åƒæ™®é€šçš„ SFTï¼ˆç›‘ç£å¾®è°ƒï¼‰ä¸€æ ·ä¸æ»‘ç¨³å®šï¼Œæå¤§åœ°é™ä½äº† RLHF çš„é—¨æ§›ã€‚</li></ul></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/Paper/" class="category-chain-item">Paper</a> <span>></span> <a href="/categories/Paper/Reinforcement-Learning/" class="category-chain-item">Reinforcement Learning</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/Research/" class="print-no-link">#Research</a> <a href="/tags/Algorithm/" class="print-no-link">#Algorithm</a> <a href="/tags/DPO/" class="print-no-link">#DPO</a></div></div><div class="license-box my-3"><div class="license-title"><div>DPOâ€”â€”ç›´æ¥åå¥½ä¼˜åŒ–ç®—æ³•</div><div>https://choucisan.xyz/DPO.html</div></div><div class="license-meta"><div class="license-meta-item"><div>Author</div><div>choucisan</div></div><div class="license-meta-item license-meta-date"><div>Posted on</div><div>December 21, 2025</div></div><div class="license-meta-item"><div>Licensed under</div><div><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - Attribution"><i class="iconfont icon-cc-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/GRPO.html" title="GRPOâ€”â€”ç»„ç›¸å¯¹ç­–ç•¥ä¼˜åŒ–ç®—æ³•"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">GRPOâ€”â€”ç»„ç›¸å¯¹ç­–ç•¥ä¼˜åŒ–ç®—æ³•</span> <span class="visible-mobile">Previous</span></a></article><article class="post-next col-6"><a href="/PPO.html" title="PPOâ€”â€”è¿‘ç«¯ç­–ç•¥ä¼˜åŒ–ç®—æ³•"><span class="hidden-mobile">PPOâ€”â€”è¿‘ç«¯ç­–ç•¥ä¼˜åŒ–ç®—æ³•</span> <span class="visible-mobile">Next</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments" lazyload><div id="valine"></div><script type="text/javascript">Fluid.utils.loadComments("#valine",function(){Fluid.utils.createScript("https://lib.baomitu.com/valine/1.5.1/Valine.min.js",function(){var i=Object.assign({appId:"H13sJOhFUDSFRB5l6uGK3P1R-gzGzoHsz",appKey:"9PsUJ7XI7U3Pg3ixfxWfPD7B",path:"window.location.pathname",placeholder:"Say something / è¯´ç‚¹ä»€ä¹ˆå§~",avatar:"retro",meta:["nick","mail","link"],requiredFields:[],pageSize:10,lang:"en",highlight:!1,recordIP:!1,serverURLs:"",emojiCDN:null,emojiMaps:null,enableQQ:!1},{el:"#valine",path:window.location.pathname});new Valine(i),Fluid.utils.waitElementVisible("#valine .vcontent",()=>{var i="#valine .vcontent img:not(.vemoji)";Fluid.plugins.imageCaption(i),Fluid.plugins.fancyBox(i)})})})</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>Table of Contents</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a></main><footer><div class="footer-inner"><div class="footer-content">Â© 2025 13 Lab. All Rights Reserved.</div><div class="statistics"><span id="leancloud-site-pv-container" style="display:none">Views: <span id="leancloud-site-pv"></span> </span><span id="leancloud-site-uv-container" style="display:none">Visitors: <span id="leancloud-site-uv"></span></span></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js",function(){var t,o=jQuery("#toc");0!==o.length&&window.tocbot&&(t=jQuery("#board-ctn").offset().top,window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-t},CONFIG.toc)),0<o.find(".toc-list-item").length&&o.css("visibility","visible"),Fluid.events.registerRefreshCallback(function(){var t;"tocbot"in window&&(tocbot.refresh(),0!==(t=jQuery("#toc")).length)&&tocbot&&0<t.find(".toc-list-item").length&&t.css("visibility","visible")}))})</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js",function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback(function(){if("anchors"in window){anchors.removeAll();var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}})})</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script>Fluid.plugins.imageCaption()</script><script>window.MathJax?(MathJax.startup.document.state(0),MathJax.texReset(),MathJax.typeset(),MathJax.typesetPromise()):window.MathJax={tex:{inlineMath:{"[+]":[["$","$"]]}},loader:{load:["ui/lazy"]},options:{renderActions:{insertedScript:[200,()=>{document.querySelectorAll("mjx-container").forEach(t=>{t=t.parentNode;"li"===t.nodeName.toLowerCase()&&t.parentNode.classList.add("has-jax")})},"",!1]}}},Fluid.events.registerRefreshCallback(function(){"MathJax"in window&&MathJax.startup.document&&"function"==typeof MathJax.startup.document.state&&(MathJax.startup.document.state(0),MathJax.texReset(),MathJax.typeset(),MathJax.typesetPromise())})</script><script src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js"></script><script defer src="/js/leancloud.js"></script><script src="/js/custom-logic.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">Blog works best with JavaScript enabled</div></noscript><script type="text/x-mathjax-config">MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>